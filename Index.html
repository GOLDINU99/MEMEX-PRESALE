<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MEMEX Presale</title>

  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>

  <style>
    :root{
      --bg0:#05060b; --bg1:#081426;
      --card:rgba(10,16,30,.72);
      --stroke:rgba(120,220,255,.16);
      --neon:#00f5ff; --neon2:#ff4dff;
      --lime:#34ff8b; --gold:#ffd166;
      --text:#eaf6ff; --muted:rgba(234,246,255,.72);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius:18px;
      --danger:#ff4dff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 20% 20%, rgba(0,245,255,.14), transparent 55%),
        radial-gradient(900px 520px at 80% 10%, rgba(255,77,255,.12), transparent 55%),
        radial-gradient(1000px 650px at 50% 90%, rgba(52,255,139,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }
    .wrap{max-width:1120px; margin:22px auto 70px; padding:0 16px}
  </style>
</head>

<body>
  <div class="wrap">
    <h1>MEMEX Presale</h1>
    <button id="btnConnect">CONNECT</button>
    <button id="btnSend">SEND 0.2 SOL</button>
    <div id="status"></div>
  </div>

<script>
const { Connection, PublicKey, SystemProgram, Transaction, LAMPORTS_PER_SOL } = solanaWeb3;

/* ======================
   CONFIG
====================== */
const CONFIG = {
  TREASURY_ADDRESS: "FBZQZgu2bkbFv3Fjgkoyjh1ZWToCxRrjSk2joFmrMAb9",

  RPC_LIST: [
    "https://solana-mainnet.g.alchemy.com/v2/uenOkKWZ9SOxMAXUPWvin",
    "https://api.mainnet-beta.solana.com"
  ],

  MIN_SOL: 0.2
};

let rpcIndex = 0;
let connection = new Connection(CONFIG.RPC_LIST[rpcIndex], "confirmed");

function rotateRpc(){
  rpcIndex = (rpcIndex + 1) % CONFIG.RPC_LIST.length;
  connection = new Connection(CONFIG.RPC_LIST[rpcIndex], "confirmed");
}

const statusEl = document.getElementById("status");
function setStatus(msg){ statusEl.textContent = msg; }

let walletPublicKey = null;

/* ======================
   CONNECT
====================== */
document.getElementById("btnConnect").onclick = async () => {
  if (!window.solana || !window.solana.isPhantom) {
    setStatus("Open in Phantom Browser");
    return;
  }
  const res = await window.solana.connect();
  walletPublicKey = res.publicKey;
  setStatus("Connected: " + walletPublicKey.toString());
};

/* ======================
   SEND SOL (UNCHANGED)
====================== */
document.getElementById("btnSend").onclick = async () => {
  try{
    if (!walletPublicKey) {
      setStatus("Connect wallet first");
      return;
    }

    const tx = new Transaction().add(
      SystemProgram.transfer({
        fromPubkey: walletPublicKey,
        toPubkey: new PublicKey(CONFIG.TREASURY_ADDRESS),
        lamports: Math.round(0.2 * LAMPORTS_PER_SOL)
      })
    );

    tx.feePayer = walletPublicKey;

    setStatus("Approve in Phantomâ€¦");

    const sig = await window.solana.signAndSendTransaction(tx);
    setStatus("Sent TX: " + sig.signature);
  }catch(e){
    setStatus("Send error: " + e.message);
  }
};
</script>
</body>
</html>
